<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>projekt</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>


</head>

<body>

  <div class="popup-container">
    <button class="close">X</button>


    <div class="popup-container_kolumna_1">
      <div class="kolumna_1_obraz"></div>

      <div class="kolumna_1_opis">
        <p class="kolumna_1_opis_element1">Chcesz dowiedzieć się szczegółowo, </p>
        <p class="kolumna_1_opis_element2">jak działa rekuperacja?</p>
        <p class="kolumna_1_opis_element3">Porozmawiaj z Doradcą <a
            href="https://www.rekuperatory.pl/">Rekuperatory.pl</a> i wypełnij
          poniższy formularz <br> <span style="font-weight: bold">-Skontaktujemy sie z Tobą!</span></p>
      </div>

    </div>

    <div class="kolumna_2_form ">

      <form method="POST" action="" class="grid-container" name="form" id="main_form" enctype="multipart/form-data">

        <div class="form_input_arrangement "><input class="form_input" name="imie" type="text" placeholder="   Imię*"
            required> <input class="form_input" name="nazwisko" type="text" placeholder="   Nazwisko*" required></div>



        <div class="form_input_arrangement "><input class="form_input" name="telefon" type="text"
            placeholder="   Telefon*"> <input class="form_input" name="email" type="email" placeholder="    Email*">
        </div>

        <div class="form_input_arrangement ">

          <select name="wojewodztwo" class="form_input  form_select" required>

            <option value="" selected disabled hidden> Województwo*</option>
            <option value="lubelskie">lubelskie</option>
            <option value="podkarpackie">podkarpackie</option>
            <option value="mazowieckie">mazowieckie</option>
            <option value="lubuskie">lubuskie</option>
            <option value="dolnoslaskie">dolnoslaskie</option>
          </select>

          <select name="powiat" class="form_input  form_select" required>

            <option value="" selected disabled hidden> Powiat*</option>
            <option value="lubelski">lubelski</option>
            <option value="podkarpacki">podkarpacki</option>
            <option value="mazowiecki">mazowiecki</option>
            <option value="lubuski">lubuski</option>
            <option value="dolnoslaski">dolnoslaski</option>
          </select>
        </div>

        <div class="stan_budowy ">

          <select name="stan_budowy" class="form_select select_full_view">

            <option value="" selected disabled hidden> Stan budowy*</option>
            <option value="w_toku">w toku</option>
            <option value="ukonczona">ukonczona</option>

          </select>

        </div>

        <div class="nazwa-projektu "><input class="select_full_view" name="nazwa_projektu" type="text"
            placeholder="Nazwa projektu"></div>

        <div class="file_header">
          <p class="file_header--description">Proszę załączyć rzuty wszystkich kondygnacji i przekroje budynku.</p>
        </div>

        <div class="add_file">
          <input name="file" type="file" accept=".jpg">
          <span class="add_file--remove remove">Usuń<i>+</i> </span>
        </div>

        <div class="add_another_file">
          <span class="add_another_file--add">Dodaj kolejny <i>+</i></span>
        </div>

        <div class="regulations">
          <input type="checkbox" name="regulamin1" required>
          <span>Zapoznałem się i akceptuję regulamin świadczenia usług serwisu Rekuperatory.pl. Wyrażam zgodę <span
              class="see_more">Czytaj wiecej...</span><span class="see_more--novisable">i akceptuję regulamin
              świadczenia usług serwisu Rekuperatory.pl. </span></span>

        </div>
        <div class="regulations">
          <input type="checkbox" name="regulamin2">
          <span>Chcę otrzymywać informacje o ofercie handlowej, aktualnych promocji i oferty handlowej.<span
              class="see_more">Czytaj wiecej...</span><span class="see_more--novisable">Chcę otrzymywać informacje o
              ofercie handlowej, aktualnych promocji i oferty handlowej. </span> </span>

        </div>

        <div>

          <select name="jak_trafiles" class="form_select select_full_view">

            <option value="" selected disabled hidden> Jak trafiłeś na rekuperatory.pl?</option>
            <option value="internet">internet</option>
            <option value="tv">tv</option>

          </select>

        </div>

        <div>
          <input class="submit" type="submit" value="Wyślij zapytanie">


        </div>

      </form>

    </div>

    <script>


      document.querySelector(".close").addEventListener('click', function (e) {
        const close_button = e.target;
        const popup_container = document.querySelector(".popup-container");

        popup_container.style.display = 'none';
        close_button.style.display = 'none';
      })




      const remove = document.querySelectorAll(".remove");
      const add_another = document.querySelector(".add_another_file--add").addEventListener('click', function (e) {
        e.preventDefault();

        let div_element = document.createElement('div');
        div_element.classList.add('add_file');

        let input_element = document.createElement('input');
        input_element.setAttribute('type', 'file');
        input_element.setAttribute('name', 'file');
        input_element.setAttribute('accept', '.jpg');
        let span_element = document.createElement('span');
        span_element.classList.add('add_file--remove');
        span_element.classList.add('remove');
        span_element.textContent = "Usuń";
        span_element.addEventListener('click', function (e) {
          e.preventDefault();
          e.target.closest('.add_file').remove()
        });

        let i_element = document.createElement('i');
        i_element.textContent = "+";

        span_element.appendChild(i_element);
        div_element.appendChild(input_element);
        div_element.appendChild(span_element);

        last_div = this.closest(".add_another_file");

        document.querySelector(".grid-container").insertBefore(div_element, last_div); //ten fragment sluzy dodawaniu i usuwaniu kolejnych pozycji plikow

      });


      [].forEach.call(remove, function (buttons) {
        buttons.addEventListener('click', function (e) {
          e.preventDefault();
          e.target.closest('.add_file').remove();
        });

      });

      const more_buttons = document.querySelectorAll(".see_more");
      [].forEach.call(more_buttons, function (buttons) {
        buttons.addEventListener('click', function (e) {
          e.preventDefault();

          console.log(e.target.nextElementSibling);
          e.target.nextElementSibling.style.setProperty('display', 'inline');
          e.target.style.setProperty('display', 'none');
        });

      });

      $(document).ready(function (e) {




        $("#main_form").submit(function (e) {
          e.preventDefault();
          if ($("#main_form")[0].checkValidity()) {   //zapobiegania wysylania formualrza zawsze nawet jak jest niepoprawny
            //alert("submit");
            const form = $(this)[0];


            const formData = new FormData(form);



            /*req = new XMLHttpRequest();
            req.open("POST", "/echo/html/");
            req.send(formData);*/

            $.ajax({
              url: "http://youlead.pl/ReceivePopup",
              type: 'POST',
              data: formData,
              success: function (data) {
                alert(data)
              },

              cache: false,
              contentType: false,
              processData: false,

            });
          }
          else {
            //$("#main_form")[0].reportValidity()  //wyswietelnie domyslnych komunikatow z przegladarki na zle wartosci pol. dubluje sie jquery wtedy
          }


        });

        $("#main_form").validate({

          rules: {

            imie: {
              required: true,

            },
            nazwisko: {
              required: true,

            },
            telefon: {
              number: true,
              minlength: 9,
              maxlength: 9,
            },

            email: {
              email: true,

            },
            wojewodztwo: {
              required: true,

            },
            powiat: {

              required: true,
            },
            stan_budowy: {


            },
            nazwa_projektu: {


            },
            file: {


            },
            regulamin1: {
              required: true,

            },
            regulamin2: {


            },


          },


          // Make sure the form is submitted to the destination defined
          // in the "action" attribute of the form when valid
          submitHandler: function (form) {

            form.submit();
          },
          invalidHandler: function (event, validator) {
          }
        });
      });

    </script>


  </div>



</body>

</html>